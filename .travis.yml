language: cpp
sudo: false

matrix:
    include:
        # 1: Linux Clang Builds
        - os: linux
          compiler: clang
          addons: &clang38
            apt:
                sources:
                    - llvm-toolchain-precise-3.8
                    - ubuntu-toolchain-r-test
                    - kalakris-cmake
                packages:
                    - clang-3.8
                    - cmake
          env:
              - CC=clang-3.8
              - CXX=clang++-3.8
              - BUILD_TYPE='Release'

        - os: linux
          compiler: clang
          addons: *clang38
          env:
              - CC=clang-3.8
              - CXX=clang++-3.8
              - BUILD_TYPE='Debug'

        # 2: Linux GCC Builds
        - os: linux
          compiler: gcc
          addons: &gcc5
            apt:
                sources:
                    - ubuntu-toolchain-r-test
                    - kalakris-cmake
                packages:
                    - g++-5
                    - cmake
          env:
              - CC=gcc-5
              - CXX=g++-5
              - BUILD_TYPE='Release'

        - os: linux
          compiler: gcc
          addons: *gcc5
          env:
              - CC=gcc-5
              - CXX=g++-5
              - BUILD_TYPE='Debug'

        - os: linux
          compiler: gcc
          addons: &gcc6
            apt:
                sources:
                    - ubuntu-toolchain-r-test
                    - kalakris-cmake
                packages:
                    - g++-6
                    - cmake
          env:
              - CC=gcc-6
              - CXX=g++-6
              - BUILD_TYPE='Release'

        - os: linux
          compiler: gcc
          addons: *gcc6
          env:
              - CC=gcc-6
              - CXX=g++-6
              - BUILD_TYPE='Debug'

        # 3: OSX Clang Builds
        - os: osx
          compiler: clang
          osx_image: xcode8
          env:
              - CC=clang-3.8
              - CXX=clang++-3.8
              - BUILD_TYPE='Debug'

before_script:
    - mkdir build
    - cd build
    - cmake -DCMAKE_BUILD_TYPE=${BUILD_TYPE} ..

script:
    - cmake --build .
    - ctest --output-on-failure
